2022-10-02 12:58:48,692 - INFO - using device:cuda:0
2022-10-02 12:58:48,692 - INFO - args:Namespace(batch_size=128, cls_id=6, cuda='True', device='cuda:0', embedding_dim=128, epochs=20, eps=1e-09, gradient_accumulation_steps=4, hidden_dim=128, ignore_index=-100, log=True, log_path='../log/', log_step=1000, lr=0.002, max_grad_norm=2.0, max_len=150, model_config='../config/config.json', model_type='lstm', num_workers=0, pad_id=0, patience=0, pretrained_model='', save_model_path='../model', sep_id=7, train_path='../data/train.pkl', val_num=8000, vec_path='../word2vec/', vec_type='random', vocab_path='../data/vocab.txt', vocab_size=8318, warmup_steps=4000)
2022-10-02 12:58:52,675 - INFO - Train:lstm-random
2022-10-02 12:58:52,675 - INFO - number of model parameters: 2401918
2022-10-02 12:58:56,462 - INFO - starting training
2022-10-02 13:07:20,267 - INFO - epoch 1: loss 6.4516467213041295, predict_acc 0.07089596908913781
2022-10-02 13:07:20,268 - INFO - saving model for epoch 1
2022-10-02 13:07:20,303 - INFO - epoch 1 finished
2022-10-02 13:07:20,303 - INFO - time for one epoch: 0:08:23.836770
2022-10-02 13:07:20,304 - INFO - start validating
2022-10-02 13:07:23,381 - INFO - validate epoch 1: loss 5.842255038599814
2022-10-02 13:07:23,382 - INFO - time for validating one epoch: 0:00:03.078434
2022-10-02 13:16:13,040 - INFO - epoch 2: loss 5.848591777703243, predict_acc 0.09047194184472554
2022-10-02 13:16:13,040 - INFO - saving model for epoch 2
2022-10-02 13:16:13,053 - INFO - epoch 2 finished
2022-10-02 13:16:13,053 - INFO - time for one epoch: 0:08:49.669081
2022-10-02 13:16:13,054 - INFO - start validating
2022-10-02 13:16:15,071 - INFO - validate epoch 2: loss 5.836384911690989
2022-10-02 13:16:15,071 - INFO - time for validating one epoch: 0:00:02.016852
2022-10-02 13:21:28,099 - INFO - epoch 3: loss 5.510284868900955, predict_acc 0.1195360755909709
2022-10-02 13:21:28,099 - INFO - saving model for epoch 3
2022-10-02 13:21:28,112 - INFO - epoch 3 finished
2022-10-02 13:21:28,112 - INFO - time for one epoch: 0:05:13.040929
2022-10-02 13:21:28,112 - INFO - start validating
2022-10-02 13:21:30,103 - INFO - validate epoch 3: loss 5.1310713906441965
2022-10-02 13:21:30,103 - INFO - time for validating one epoch: 0:00:01.991545
2022-10-02 13:26:41,580 - INFO - epoch 4: loss 4.8896259405387745, predict_acc 0.19448404672195194
2022-10-02 13:26:41,581 - INFO - saving model for epoch 4
2022-10-02 13:26:41,593 - INFO - epoch 4 finished
2022-10-02 13:26:41,593 - INFO - time for one epoch: 0:05:11.489728
2022-10-02 13:26:41,593 - INFO - start validating
2022-10-02 13:26:43,519 - INFO - validate epoch 4: loss 4.646595201184673
2022-10-02 13:26:43,519 - INFO - time for validating one epoch: 0:00:01.925520
2022-10-02 13:31:54,836 - INFO - epoch 5: loss 4.507344291447787, predict_acc 0.23751577249386902
2022-10-02 13:31:54,836 - INFO - saving model for epoch 5
2022-10-02 13:31:54,850 - INFO - epoch 5 finished
2022-10-02 13:31:54,850 - INFO - time for one epoch: 0:05:11.330092
2022-10-02 13:31:54,850 - INFO - start validating
2022-10-02 13:31:56,825 - INFO - validate epoch 5: loss 4.373703710494503
2022-10-02 13:31:56,825 - INFO - time for validating one epoch: 0:00:01.975548
2022-10-02 13:37:08,214 - INFO - epoch 6: loss 4.315724697827735, predict_acc 0.2553124334432777
2022-10-02 13:37:08,214 - INFO - saving model for epoch 6
2022-10-02 13:37:08,226 - INFO - epoch 6 finished
2022-10-02 13:37:08,226 - INFO - time for one epoch: 0:05:11.400928
2022-10-02 13:37:08,226 - INFO - start validating
2022-10-02 13:37:10,168 - INFO - validate epoch 6: loss 4.24741808829769
2022-10-02 13:37:10,168 - INFO - time for validating one epoch: 0:00:01.941537
2022-10-02 13:42:21,723 - INFO - epoch 7: loss 4.214212819681855, predict_acc 0.2645523689596446
2022-10-02 13:42:21,723 - INFO - saving model for epoch 7
2022-10-02 13:42:21,735 - INFO - epoch 7 finished
2022-10-02 13:42:21,735 - INFO - time for one epoch: 0:05:11.567360
2022-10-02 13:42:21,735 - INFO - start validating
2022-10-02 13:42:23,697 - INFO - validate epoch 7: loss 4.171637527404293
2022-10-02 13:42:23,698 - INFO - time for validating one epoch: 0:00:01.962673
2022-10-02 13:47:35,221 - INFO - epoch 8: loss 4.149004971456813, predict_acc 0.2705938097448004
2022-10-02 13:47:35,221 - INFO - saving model for epoch 8
2022-10-02 13:47:35,233 - INFO - epoch 8 finished
2022-10-02 13:47:35,233 - INFO - time for one epoch: 0:05:11.534811
2022-10-02 13:47:35,234 - INFO - start validating
2022-10-02 13:47:37,184 - INFO - validate epoch 8: loss 4.1217360496521
2022-10-02 13:47:37,184 - INFO - time for validating one epoch: 0:00:01.950572
2022-10-02 13:52:48,535 - INFO - epoch 9: loss 4.102568100927523, predict_acc 0.27491958273129163
2022-10-02 13:52:48,535 - INFO - saving model for epoch 9
2022-10-02 13:52:48,549 - INFO - epoch 9 finished
2022-10-02 13:52:48,549 - INFO - time for one epoch: 0:05:11.363768
2022-10-02 13:52:48,549 - INFO - start validating
2022-10-02 13:52:50,504 - INFO - validate epoch 9: loss 4.085720004573945
2022-10-02 13:52:50,504 - INFO - time for validating one epoch: 0:00:01.954524
2022-10-02 13:58:02,201 - INFO - epoch 10: loss 4.068585142318761, predict_acc 0.2780208303634717
2022-10-02 13:58:02,201 - INFO - saving model for epoch 10
2022-10-02 13:58:02,214 - INFO - epoch 10 finished
2022-10-02 13:58:02,215 - INFO - time for one epoch: 0:05:11.711124
2022-10-02 13:58:02,215 - INFO - start validating
2022-10-02 13:58:04,166 - INFO - validate epoch 10: loss 4.061623461784855
2022-10-02 13:58:04,166 - INFO - time for validating one epoch: 0:00:01.951569
2022-10-02 14:03:15,884 - INFO - epoch 11: loss 4.042133560039214, predict_acc 0.28055473639372197
2022-10-02 14:03:15,885 - INFO - saving model for epoch 11
2022-10-02 14:03:15,896 - INFO - epoch 11 finished
2022-10-02 14:03:15,897 - INFO - time for one epoch: 0:05:11.729417
2022-10-02 14:03:15,897 - INFO - start validating
2022-10-02 14:03:17,834 - INFO - validate epoch 11: loss 4.038133725043266
2022-10-02 14:03:17,834 - INFO - time for validating one epoch: 0:00:01.937365
2022-10-02 14:08:29,398 - INFO - epoch 12: loss 4.021116877855375, predict_acc 0.2825316012666042
2022-10-02 14:08:29,399 - INFO - saving model for epoch 12
2022-10-02 14:08:29,410 - INFO - epoch 12 finished
2022-10-02 14:08:29,410 - INFO - time for one epoch: 0:05:11.574543
2022-10-02 14:08:29,410 - INFO - start validating
2022-10-02 14:08:31,397 - INFO - validate epoch 12: loss 4.022045577726057
2022-10-02 14:08:31,398 - INFO - time for validating one epoch: 0:00:01.987527
2022-10-02 14:13:42,103 - INFO - epoch 13: loss 4.0039742581707225, predict_acc 0.28416065153971554
2022-10-02 14:13:42,104 - INFO - saving model for epoch 13
2022-10-02 14:13:42,116 - INFO - epoch 13 finished
2022-10-02 14:13:42,116 - INFO - time for one epoch: 0:05:10.717837
2022-10-02 14:13:42,116 - INFO - start validating
2022-10-02 14:13:44,080 - INFO - validate epoch 13: loss 4.00806438538336
2022-10-02 14:13:44,080 - INFO - time for validating one epoch: 0:00:01.964566
2022-10-02 14:18:55,208 - INFO - epoch 14: loss 3.9901384580827086, predict_acc 0.2854556083988408
2022-10-02 14:18:55,208 - INFO - saving model for epoch 14
2022-10-02 14:18:55,221 - INFO - epoch 14 finished
2022-10-02 14:18:55,221 - INFO - time for one epoch: 0:05:11.140780
2022-10-02 14:18:55,221 - INFO - start validating
2022-10-02 14:18:57,179 - INFO - validate epoch 14: loss 3.9990423840861165
2022-10-02 14:18:57,179 - INFO - time for validating one epoch: 0:00:01.957544
2022-10-02 14:24:08,633 - INFO - epoch 15: loss 3.978742791065908, predict_acc 0.2866640158121383
2022-10-02 14:24:08,633 - INFO - saving model for epoch 15
2022-10-02 14:24:08,645 - INFO - epoch 15 finished
2022-10-02 14:24:08,645 - INFO - time for one epoch: 0:05:11.464848
2022-10-02 14:24:08,645 - INFO - start validating
2022-10-02 14:24:10,596 - INFO - validate epoch 15: loss 3.9922619096694456
2022-10-02 14:24:10,596 - INFO - time for validating one epoch: 0:00:01.950026
2022-10-02 14:29:22,241 - INFO - epoch 16: loss 3.969012144422767, predict_acc 0.2875425304479291
2022-10-02 14:29:22,242 - INFO - saving model for epoch 16
2022-10-02 14:29:22,265 - INFO - epoch 16 finished
2022-10-02 14:29:22,265 - INFO - time for one epoch: 0:05:11.669037
2022-10-02 14:29:22,268 - INFO - start validating
2022-10-02 14:29:25,107 - INFO - validate epoch 16: loss 3.984023132631856
2022-10-02 14:29:25,108 - INFO - time for validating one epoch: 0:00:02.839864
2022-10-02 14:34:35,351 - INFO - epoch 17: loss 3.9613118470723263, predict_acc 0.2883493629654769
2022-10-02 14:34:35,351 - INFO - saving model for epoch 17
2022-10-02 14:34:35,364 - INFO - epoch 17 finished
2022-10-02 14:34:35,364 - INFO - time for one epoch: 0:05:10.256166
2022-10-02 14:34:35,364 - INFO - start validating
2022-10-02 14:34:37,329 - INFO - validate epoch 17: loss 3.977997749082504
2022-10-02 14:34:37,330 - INFO - time for validating one epoch: 0:00:01.965564
2022-10-02 14:41:34,439 - INFO - epoch 18: loss 3.95501170244001, predict_acc 0.28904455967768294
2022-10-02 14:41:34,439 - INFO - saving model for epoch 18
2022-10-02 14:41:34,454 - INFO - epoch 18 finished
2022-10-02 14:41:34,454 - INFO - time for one epoch: 0:06:57.124360
2022-10-02 14:41:34,454 - INFO - start validating
2022-10-02 14:41:37,699 - INFO - validate epoch 18: loss 3.974246940305156
2022-10-02 14:41:37,700 - INFO - time for validating one epoch: 0:00:03.245537
2022-10-02 14:47:59,342 - INFO - epoch 19: loss 3.9500130538731977, predict_acc 0.2895438639395165
2022-10-02 14:47:59,342 - INFO - saving model for epoch 19
2022-10-02 14:47:59,355 - INFO - epoch 19 finished
2022-10-02 14:47:59,355 - INFO - time for one epoch: 0:06:21.655799
2022-10-02 14:47:59,356 - INFO - start validating
2022-10-02 14:48:01,395 - INFO - validate epoch 19: loss 3.9719140221995692
2022-10-02 14:48:01,395 - INFO - time for validating one epoch: 0:00:02.038668
2022-10-02 14:54:26,476 - INFO - epoch 20: loss 3.946388899023695, predict_acc 0.28993033985206534
2022-10-02 14:54:26,476 - INFO - saving model for epoch 20
2022-10-02 14:54:26,494 - INFO - epoch 20 finished
2022-10-02 14:54:26,495 - INFO - time for one epoch: 0:06:25.099553
2022-10-02 14:54:26,495 - INFO - start validating
2022-10-02 14:54:29,167 - INFO - validate epoch 20: loss 3.9697845635875577
2022-10-02 14:54:29,168 - INFO - time for validating one epoch: 0:00:02.672961
2022-10-02 14:54:29,168 - INFO - training finished
2022-10-02 14:54:29,169 - INFO - train_losses:[6.4516467213041295, 5.848591777703243, 5.510284868900955, 4.8896259405387745, 4.507344291447787, 4.315724697827735, 4.214212819681855, 4.149004971456813, 4.102568100927523, 4.068585142318761, 4.042133560039214, 4.021116877855375, 4.0039742581707225, 3.9901384580827086, 3.978742791065908, 3.969012144422767, 3.9613118470723263, 3.95501170244001, 3.9500130538731977, 3.946388899023695]
2022-10-02 14:54:29,169 - INFO - validate_losses:[5.842255038599814, 5.836384911690989, 5.1310713906441965, 4.646595201184673, 4.373703710494503, 4.24741808829769, 4.171637527404293, 4.1217360496521, 4.085720004573945, 4.061623461784855, 4.038133725043266, 4.022045577726057, 4.00806438538336, 3.9990423840861165, 3.9922619096694456, 3.984023132631856, 3.977997749082504, 3.974246940305156, 3.9719140221995692, 3.9697845635875577]
2022-10-02 14:54:29,207 - INFO - using device:cuda:0
2022-10-02 14:54:29,208 - INFO - args:Namespace(batch_size=128, cls_id=6, cuda='True', device='cuda:0', embedding_dim=128, epochs=20, eps=1e-09, gradient_accumulation_steps=4, hidden_dim=128, ignore_index=-100, log=True, log_path='../log/', log_step=1000, lr=0.002, max_grad_norm=2.0, max_len=150, model_config='../config/config.json', model_type='lstm', num_workers=0, pad_id=0, patience=0, pretrained_model='', save_model_path='../model', sep_id=7, train_path='../data/train.pkl', val_num=8000, vec_path='../word2vec/', vec_type='ffn', vocab_path='../data/vocab.txt', vocab_size=8318, warmup_steps=4000)
2022-10-02 14:54:29,639 - INFO - Train:lstm-ffn
2022-10-02 14:54:29,639 - INFO - number of model parameters: 2401918
2022-10-02 14:54:29,679 - INFO - starting training
2022-10-02 15:00:30,456 - INFO - epoch 1: loss 6.449108095613272, predict_acc 0.0712952719123481
2022-10-02 15:00:30,457 - INFO - saving model for epoch 1
2022-10-02 15:00:30,474 - INFO - epoch 1 finished
2022-10-02 15:00:30,475 - INFO - time for one epoch: 0:06:00.731585
2022-10-02 15:00:30,475 - INFO - start validating
2022-10-02 15:00:33,443 - INFO - validate epoch 1: loss 5.843388180578908
2022-10-02 15:00:33,444 - INFO - time for validating one epoch: 0:00:02.968721
2022-10-02 15:06:10,178 - INFO - epoch 2: loss 5.840767140007565, predict_acc 0.09047234192114638
2022-10-02 15:06:10,178 - INFO - saving model for epoch 2
2022-10-02 15:06:10,191 - INFO - epoch 2 finished
2022-10-02 15:06:10,192 - INFO - time for one epoch: 0:05:36.747931
2022-10-02 15:06:10,192 - INFO - start validating
2022-10-02 15:06:12,320 - INFO - validate epoch 2: loss 5.738481606206586
2022-10-02 15:06:12,320 - INFO - time for validating one epoch: 0:00:02.128945
2022-10-02 15:11:48,845 - INFO - epoch 3: loss 5.226859998616147, predict_acc 0.14914567483153524
2022-10-02 15:11:48,846 - INFO - saving model for epoch 3
2022-10-02 15:11:48,859 - INFO - epoch 3 finished
2022-10-02 15:11:48,859 - INFO - time for one epoch: 0:05:36.538938
2022-10-02 15:11:48,859 - INFO - start validating
2022-10-02 15:11:50,940 - INFO - validate epoch 3: loss 4.812318255824428
2022-10-02 15:11:50,940 - INFO - time for validating one epoch: 0:00:02.080134
2022-10-02 15:17:41,466 - INFO - epoch 4: loss 4.6111141415024495, predict_acc 0.2253102374704187
2022-10-02 15:17:41,467 - INFO - saving model for epoch 4
2022-10-02 15:17:41,480 - INFO - epoch 4 finished
2022-10-02 15:17:41,481 - INFO - time for one epoch: 0:05:50.541515
2022-10-02 15:17:41,481 - INFO - start validating
2022-10-02 15:17:43,535 - INFO - validate epoch 4: loss 4.438335664810673
2022-10-02 15:17:43,536 - INFO - time for validating one epoch: 0:00:02.055258
2022-10-02 15:23:44,626 - INFO - epoch 5: loss 4.355332012260888, predict_acc 0.2506937412428568
2022-10-02 15:23:44,627 - INFO - saving model for epoch 5
2022-10-02 15:23:44,640 - INFO - epoch 5 finished
2022-10-02 15:23:44,640 - INFO - time for one epoch: 0:06:01.103800
2022-10-02 15:23:44,640 - INFO - start validating
2022-10-02 15:23:47,311 - INFO - validate epoch 5: loss 4.273321190188008
2022-10-02 15:23:47,311 - INFO - time for validating one epoch: 0:00:02.671338
2022-10-02 15:30:19,856 - INFO - epoch 6: loss 4.23125726265303, predict_acc 0.2620726616295703
2022-10-02 15:30:19,856 - INFO - saving model for epoch 6
2022-10-02 15:30:19,875 - INFO - epoch 6 finished
2022-10-02 15:30:19,875 - INFO - time for one epoch: 0:06:32.563758
2022-10-02 15:30:19,875 - INFO - start validating
2022-10-02 15:30:23,644 - INFO - validate epoch 6: loss 4.184783174145606
2022-10-02 15:30:23,644 - INFO - time for validating one epoch: 0:00:03.769123
2022-10-02 15:36:03,362 - INFO - epoch 7: loss 4.156834996866429, predict_acc 0.26899140880638533
2022-10-02 15:36:03,362 - INFO - saving model for epoch 7
2022-10-02 15:36:03,375 - INFO - epoch 7 finished
2022-10-02 15:36:03,375 - INFO - time for one epoch: 0:05:39.730763
2022-10-02 15:36:03,375 - INFO - start validating
2022-10-02 15:36:05,401 - INFO - validate epoch 7: loss 4.1260847737712245
2022-10-02 15:36:05,401 - INFO - time for validating one epoch: 0:00:02.024632
2022-10-02 15:42:10,693 - INFO - epoch 8: loss 4.1061122487554815, predict_acc 0.27393421995338085
2022-10-02 15:42:10,693 - INFO - saving model for epoch 8
2022-10-02 15:42:10,712 - INFO - epoch 8 finished
2022-10-02 15:42:10,712 - INFO - time for one epoch: 0:06:05.311045
2022-10-02 15:42:10,712 - INFO - start validating
2022-10-02 15:42:13,399 - INFO - validate epoch 8: loss 4.08890781094951
2022-10-02 15:42:13,400 - INFO - time for validating one epoch: 0:00:02.688616
2022-10-02 15:48:33,659 - INFO - epoch 9: loss 4.070337883358413, predict_acc 0.2774249216541948
2022-10-02 15:48:33,659 - INFO - saving model for epoch 9
2022-10-02 15:48:33,675 - INFO - epoch 9 finished
2022-10-02 15:48:33,676 - INFO - time for one epoch: 0:06:20.275581
2022-10-02 15:48:33,676 - INFO - start validating
2022-10-02 15:48:35,695 - INFO - validate epoch 9: loss 4.061738325703528
2022-10-02 15:48:35,695 - INFO - time for validating one epoch: 0:00:02.019389
2022-10-02 15:54:27,332 - INFO - epoch 10: loss 4.043180786567587, predict_acc 0.27993746243735135
2022-10-02 15:54:27,332 - INFO - saving model for epoch 10
2022-10-02 15:54:27,348 - INFO - epoch 10 finished
2022-10-02 15:54:27,348 - INFO - time for one epoch: 0:05:51.652814
2022-10-02 15:54:27,348 - INFO - start validating
2022-10-02 15:54:29,472 - INFO - validate epoch 10: loss 4.039641584119489
2022-10-02 15:54:29,472 - INFO - time for validating one epoch: 0:00:02.122956
2022-10-02 16:00:08,163 - INFO - epoch 11: loss 4.021991400057345, predict_acc 0.28204799767157546
2022-10-02 16:00:08,164 - INFO - saving model for epoch 11
2022-10-02 16:00:08,178 - INFO - epoch 11 finished
2022-10-02 16:00:08,178 - INFO - time for one epoch: 0:05:38.705125
2022-10-02 16:00:08,178 - INFO - start validating
2022-10-02 16:00:10,284 - INFO - validate epoch 11: loss 4.02355626321608
2022-10-02 16:00:10,285 - INFO - time for validating one epoch: 0:00:02.107068
2022-10-02 16:05:42,921 - INFO - epoch 12: loss 4.004830322506339, predict_acc 0.28370840018125704
2022-10-02 16:05:42,922 - INFO - saving model for epoch 12
2022-10-02 16:05:42,937 - INFO - epoch 12 finished
2022-10-02 16:05:42,937 - INFO - time for one epoch: 0:05:32.651472
2022-10-02 16:05:42,937 - INFO - start validating
2022-10-02 16:05:45,162 - INFO - validate epoch 12: loss 4.01034261334327
2022-10-02 16:05:45,162 - INFO - time for validating one epoch: 0:00:02.225246
2022-10-02 16:11:18,395 - INFO - epoch 13: loss 3.9906704499018617, predict_acc 0.28516533051917087
2022-10-02 16:11:18,395 - INFO - saving model for epoch 13
2022-10-02 16:11:18,411 - INFO - epoch 13 finished
2022-10-02 16:11:18,412 - INFO - time for one epoch: 0:05:33.249844
2022-10-02 16:11:18,412 - INFO - start validating
2022-10-02 16:11:20,934 - INFO - validate epoch 13: loss 3.9998290961788547
2022-10-02 16:11:20,934 - INFO - time for validating one epoch: 0:00:02.521834
2022-10-02 16:21:55,810 - INFO - epoch 14: loss 3.978864134831445, predict_acc 0.28631361626581875
2022-10-02 16:21:55,810 - INFO - saving model for epoch 14
2022-10-02 16:21:55,829 - INFO - epoch 14 finished
2022-10-02 16:21:55,829 - INFO - time for one epoch: 0:10:34.894864
2022-10-02 16:21:55,829 - INFO - start validating
2022-10-02 16:22:01,114 - INFO - validate epoch 14: loss 3.9934807131367345
2022-10-02 16:22:01,114 - INFO - time for validating one epoch: 0:00:05.284307
2022-10-02 16:34:40,506 - INFO - epoch 15: loss 3.96915030094785, predict_acc 0.28731798721180946
2022-10-02 16:34:40,506 - INFO - saving model for epoch 15
2022-10-02 16:34:40,522 - INFO - epoch 15 finished
2022-10-02 16:34:40,522 - INFO - time for one epoch: 0:12:39.406898
2022-10-02 16:34:40,522 - INFO - start validating
2022-10-02 16:34:44,339 - INFO - validate epoch 15: loss 3.983881462004877
2022-10-02 16:34:44,339 - INFO - time for validating one epoch: 0:00:03.816992
2022-10-02 16:43:56,866 - INFO - epoch 16: loss 3.9607874899831192, predict_acc 0.2881988009686156
2022-10-02 16:43:56,866 - INFO - saving model for epoch 16
2022-10-02 16:43:56,878 - INFO - epoch 16 finished
2022-10-02 16:43:56,878 - INFO - time for one epoch: 0:09:12.538541
2022-10-02 16:43:56,878 - INFO - start validating
2022-10-02 16:43:59,098 - INFO - validate epoch 16: loss 3.980129591880306
2022-10-02 16:43:59,099 - INFO - time for validating one epoch: 0:00:02.219578
2022-10-02 16:52:49,710 - INFO - epoch 17: loss 3.9538228902660433, predict_acc 0.288917664678126
2022-10-02 16:52:49,710 - INFO - saving model for epoch 17
2022-10-02 16:52:49,723 - INFO - epoch 17 finished
2022-10-02 16:52:49,724 - INFO - time for one epoch: 0:08:50.625133
2022-10-02 16:52:49,724 - INFO - start validating
2022-10-02 16:52:52,062 - INFO - validate epoch 17: loss 3.9723427334139423
2022-10-02 16:52:52,062 - INFO - time for validating one epoch: 0:00:02.338251
2022-10-02 16:58:57,398 - INFO - epoch 18: loss 3.9481000470333414, predict_acc 0.2895543870662725
2022-10-02 16:58:57,398 - INFO - saving model for epoch 18
2022-10-02 16:58:57,411 - INFO - epoch 18 finished
2022-10-02 16:58:57,411 - INFO - time for one epoch: 0:06:05.349125
2022-10-02 16:58:57,411 - INFO - start validating
2022-10-02 16:58:59,664 - INFO - validate epoch 18: loss 3.9703029201876734
2022-10-02 16:58:59,664 - INFO - time for validating one epoch: 0:00:02.251228
2022-10-02 17:04:59,886 - INFO - epoch 19: loss 3.943529254906878, predict_acc 0.2900077682654344
2022-10-02 17:04:59,887 - INFO - saving model for epoch 19
2022-10-02 17:04:59,900 - INFO - epoch 19 finished
2022-10-02 17:04:59,900 - INFO - time for one epoch: 0:06:00.236806
2022-10-02 17:04:59,901 - INFO - start validating
2022-10-02 17:05:02,244 - INFO - validate epoch 19: loss 3.9674348254357614
2022-10-02 17:05:02,245 - INFO - time for validating one epoch: 0:00:02.343321
2022-10-02 17:10:31,152 - INFO - epoch 20: loss 3.9401242117567854, predict_acc 0.29043523187784687
2022-10-02 17:10:31,152 - INFO - saving model for epoch 20
2022-10-02 17:10:31,165 - INFO - epoch 20 finished
2022-10-02 17:10:31,166 - INFO - time for one epoch: 0:05:28.921177
2022-10-02 17:10:31,166 - INFO - start validating
2022-10-02 17:10:33,164 - INFO - validate epoch 20: loss 3.9652467004714476
2022-10-02 17:10:33,164 - INFO - time for validating one epoch: 0:00:01.997965
2022-10-02 17:10:33,164 - INFO - training finished
2022-10-02 17:10:33,165 - INFO - train_losses:[6.449108095613272, 5.840767140007565, 5.226859998616147, 4.6111141415024495, 4.355332012260888, 4.23125726265303, 4.156834996866429, 4.1061122487554815, 4.070337883358413, 4.043180786567587, 4.021991400057345, 4.004830322506339, 3.9906704499018617, 3.978864134831445, 3.96915030094785, 3.9607874899831192, 3.9538228902660433, 3.9481000470333414, 3.943529254906878, 3.9401242117567854]
2022-10-02 17:10:33,165 - INFO - validate_losses:[5.843388180578908, 5.738481606206586, 4.812318255824428, 4.438335664810673, 4.273321190188008, 4.184783174145606, 4.1260847737712245, 4.08890781094951, 4.061738325703528, 4.039641584119489, 4.02355626321608, 4.01034261334327, 3.9998290961788547, 3.9934807131367345, 3.983881462004877, 3.980129591880306, 3.9723427334139423, 3.9703029201876734, 3.9674348254357614, 3.9652467004714476]
2022-10-02 17:10:33,175 - INFO - using device:cuda:0
2022-10-02 17:10:33,176 - INFO - args:Namespace(batch_size=128, cls_id=6, cuda='True', device='cuda:0', embedding_dim=128, epochs=20, eps=1e-09, gradient_accumulation_steps=4, hidden_dim=128, ignore_index=-100, log=True, log_path='../log/', log_step=1000, lr=0.002, max_grad_norm=2.0, max_len=150, model_config='../config/config.json', model_type='lstm', num_workers=0, pad_id=0, patience=0, pretrained_model='', save_model_path='../model', sep_id=7, train_path='../data/train.pkl', val_num=8000, vec_path='../word2vec/', vec_type='rnnlm', vocab_path='../data/vocab.txt', vocab_size=8318, warmup_steps=4000)
2022-10-02 17:10:33,597 - INFO - Train:lstm-rnnlm
2022-10-02 17:10:33,597 - INFO - number of model parameters: 2401918
2022-10-02 17:10:33,616 - INFO - starting training
2022-10-02 17:15:46,082 - INFO - epoch 1: loss 6.452935256903413, predict_acc 0.07142114134356295
2022-10-02 17:15:46,082 - INFO - saving model for epoch 1
2022-10-02 17:15:46,095 - INFO - epoch 1 finished
2022-10-02 17:15:46,096 - INFO - time for one epoch: 0:05:12.308097
2022-10-02 17:15:46,096 - INFO - start validating
2022-10-02 17:15:48,063 - INFO - validate epoch 1: loss 5.842085638353901
2022-10-02 17:15:48,063 - INFO - time for validating one epoch: 0:00:01.966784
2022-10-02 17:20:59,910 - INFO - epoch 2: loss 5.84880469808844, predict_acc 0.09046874989989413
2022-10-02 17:20:59,910 - INFO - saving model for epoch 2
2022-10-02 17:20:59,923 - INFO - epoch 2 finished
2022-10-02 17:20:59,923 - INFO - time for one epoch: 0:05:11.858829
2022-10-02 17:20:59,923 - INFO - start validating
2022-10-02 17:21:01,883 - INFO - validate epoch 2: loss 5.83592285648469
2022-10-02 17:21:01,883 - INFO - time for validating one epoch: 0:00:01.959068
2022-10-02 17:26:26,650 - INFO - epoch 3: loss 5.504782692578941, predict_acc 0.11926359354565053
2022-10-02 17:26:26,651 - INFO - saving model for epoch 3
2022-10-02 17:26:26,664 - INFO - epoch 3 finished
2022-10-02 17:26:26,664 - INFO - time for one epoch: 0:05:24.780625
2022-10-02 17:26:26,664 - INFO - start validating
2022-10-02 17:26:28,952 - INFO - validate epoch 3: loss 5.140258258388888
2022-10-02 17:26:28,952 - INFO - time for validating one epoch: 0:00:02.288213
2022-10-02 17:32:33,009 - INFO - epoch 4: loss 4.866746432701189, predict_acc 0.1968671609521345
2022-10-02 17:32:33,009 - INFO - saving model for epoch 4
2022-10-02 17:32:33,022 - INFO - epoch 4 finished
2022-10-02 17:32:33,022 - INFO - time for one epoch: 0:06:04.069379
2022-10-02 17:32:33,022 - INFO - start validating
2022-10-02 17:32:35,227 - INFO - validate epoch 4: loss 4.612686257208547
2022-10-02 17:32:35,227 - INFO - time for validating one epoch: 0:00:02.204285
2022-10-02 17:38:55,271 - INFO - epoch 5: loss 4.4748978772387975, predict_acc 0.24024134225061328
2022-10-02 17:38:55,271 - INFO - saving model for epoch 5
2022-10-02 17:38:55,286 - INFO - epoch 5 finished
2022-10-02 17:38:55,286 - INFO - time for one epoch: 0:06:20.058570
2022-10-02 17:38:55,286 - INFO - start validating
2022-10-02 17:38:57,468 - INFO - validate epoch 5: loss 4.34886460919534
2022-10-02 17:38:57,468 - INFO - time for validating one epoch: 0:00:02.181826
2022-10-02 17:44:16,138 - INFO - epoch 6: loss 4.293014819690904, predict_acc 0.2572005011750265
2022-10-02 17:44:16,138 - INFO - saving model for epoch 6
2022-10-02 17:44:16,150 - INFO - epoch 6 finished
2022-10-02 17:44:16,150 - INFO - time for one epoch: 0:05:18.681735
2022-10-02 17:44:16,151 - INFO - start validating
2022-10-02 17:44:18,148 - INFO - validate epoch 6: loss 4.231362396670926
2022-10-02 17:44:18,149 - INFO - time for validating one epoch: 0:00:01.997306
2022-10-02 17:49:29,889 - INFO - epoch 7: loss 4.198841280531455, predict_acc 0.26547154367591935
2022-10-02 17:49:29,889 - INFO - saving model for epoch 7
2022-10-02 17:49:29,902 - INFO - epoch 7 finished
2022-10-02 17:49:29,902 - INFO - time for one epoch: 0:05:11.753539
2022-10-02 17:49:29,902 - INFO - start validating
2022-10-02 17:49:31,837 - INFO - validate epoch 7: loss 4.161822642049482
2022-10-02 17:49:31,837 - INFO - time for validating one epoch: 0:00:01.934832
2022-10-02 17:54:43,058 - INFO - epoch 8: loss 4.139222974489358, predict_acc 0.27090382060318347
2022-10-02 17:54:43,058 - INFO - saving model for epoch 8
2022-10-02 17:54:43,072 - INFO - epoch 8 finished
2022-10-02 17:54:43,072 - INFO - time for one epoch: 0:05:11.234817
2022-10-02 17:54:43,072 - INFO - start validating
2022-10-02 17:54:45,031 - INFO - validate epoch 8: loss 4.115418095742503
2022-10-02 17:54:45,032 - INFO - time for validating one epoch: 0:00:01.960296
2022-10-02 17:59:58,588 - INFO - epoch 9: loss 4.096574731770202, predict_acc 0.27484938780359264
2022-10-02 17:59:58,588 - INFO - saving model for epoch 9
2022-10-02 17:59:58,603 - INFO - epoch 9 finished
2022-10-02 17:59:58,603 - INFO - time for one epoch: 0:05:13.570467
2022-10-02 17:59:58,603 - INFO - start validating
2022-10-02 18:00:00,570 - INFO - validate epoch 9: loss 4.080973659792254
2022-10-02 18:00:00,571 - INFO - time for validating one epoch: 0:00:01.968442
2022-10-02 18:05:52,492 - INFO - epoch 10: loss 4.064923918560523, predict_acc 0.2778335127571525
2022-10-02 18:05:52,492 - INFO - saving model for epoch 10
2022-10-02 18:05:52,505 - INFO - epoch 10 finished
2022-10-02 18:05:52,505 - INFO - time for one epoch: 0:05:51.933327
2022-10-02 18:05:52,505 - INFO - start validating
2022-10-02 18:05:54,726 - INFO - validate epoch 10: loss 4.05679528943954
2022-10-02 18:05:54,727 - INFO - time for validating one epoch: 0:00:02.221953
2022-10-02 18:11:49,372 - INFO - epoch 11: loss 4.040317541294162, predict_acc 0.280210367275079
2022-10-02 18:11:49,372 - INFO - saving model for epoch 11
2022-10-02 18:11:49,385 - INFO - epoch 11 finished
2022-10-02 18:11:49,385 - INFO - time for one epoch: 0:05:54.658840
2022-10-02 18:11:49,385 - INFO - start validating
2022-10-02 18:11:51,560 - INFO - validate epoch 11: loss 4.037642705825068
2022-10-02 18:11:51,560 - INFO - time for validating one epoch: 0:00:02.174258
2022-10-02 18:17:08,668 - INFO - epoch 12: loss 4.020454346559769, predict_acc 0.28208560622123074
2022-10-02 18:17:08,668 - INFO - saving model for epoch 12
2022-10-02 18:17:08,681 - INFO - epoch 12 finished
2022-10-02 18:17:08,681 - INFO - time for one epoch: 0:05:17.120042
2022-10-02 18:17:08,682 - INFO - start validating
2022-10-02 18:17:10,643 - INFO - validate epoch 12: loss 4.020590413001276
2022-10-02 18:17:10,643 - INFO - time for validating one epoch: 0:00:01.961401
2022-10-02 18:22:21,634 - INFO - epoch 13: loss 4.004453166586454, predict_acc 0.2836573903754759
2022-10-02 18:22:21,634 - INFO - saving model for epoch 13
2022-10-02 18:22:21,648 - INFO - epoch 13 finished
2022-10-02 18:22:21,648 - INFO - time for one epoch: 0:05:11.003876
2022-10-02 18:22:21,648 - INFO - start validating
2022-10-02 18:22:23,600 - INFO - validate epoch 13: loss 4.010497081664301
2022-10-02 18:22:23,601 - INFO - time for validating one epoch: 0:00:01.953019
2022-10-02 18:27:34,840 - INFO - epoch 14: loss 3.991115715117185, predict_acc 0.2849298069812684
2022-10-02 18:27:34,840 - INFO - saving model for epoch 14
2022-10-02 18:27:34,852 - INFO - epoch 14 finished
2022-10-02 18:27:34,852 - INFO - time for one epoch: 0:05:11.251349
2022-10-02 18:27:34,852 - INFO - start validating
2022-10-02 18:27:36,804 - INFO - validate epoch 14: loss 3.9991203815706315
2022-10-02 18:27:36,805 - INFO - time for validating one epoch: 0:00:01.950431
2022-10-02 18:32:45,742 - INFO - epoch 15: loss 3.980092799945824, predict_acc 0.2859898034257879
2022-10-02 18:32:45,742 - INFO - saving model for epoch 15
2022-10-02 18:32:45,756 - INFO - epoch 15 finished
2022-10-02 18:32:45,756 - INFO - time for one epoch: 0:05:08.951208
2022-10-02 18:32:45,756 - INFO - start validating
2022-10-02 18:32:47,715 - INFO - validate epoch 15: loss 3.991109698049484
2022-10-02 18:32:47,715 - INFO - time for validating one epoch: 0:00:01.959470
2022-10-02 18:40:42,773 - INFO - epoch 16: loss 3.970891044377474, predict_acc 0.28691268149690957
2022-10-02 18:40:42,773 - INFO - saving model for epoch 16
2022-10-02 18:40:42,788 - INFO - epoch 16 finished
2022-10-02 18:40:42,788 - INFO - time for one epoch: 0:07:55.072487
2022-10-02 18:40:42,788 - INFO - start validating
2022-10-02 18:40:45,227 - INFO - validate epoch 16: loss 3.983988235073705
2022-10-02 18:40:45,227 - INFO - time for validating one epoch: 0:00:02.438629
2022-10-02 18:48:52,233 - INFO - epoch 17: loss 3.963239038421746, predict_acc 0.28769847099117174
2022-10-02 18:48:52,233 - INFO - saving model for epoch 17
2022-10-02 18:48:52,246 - INFO - epoch 17 finished
2022-10-02 18:48:52,246 - INFO - time for one epoch: 0:08:07.018760
2022-10-02 18:48:52,246 - INFO - start validating
2022-10-02 18:48:54,269 - INFO - validate epoch 17: loss 3.97857153800226
2022-10-02 18:48:54,269 - INFO - time for validating one epoch: 0:00:02.022477
2022-10-02 18:54:44,195 - INFO - epoch 18: loss 3.9571356880705153, predict_acc 0.2883059832811606
2022-10-02 18:54:44,195 - INFO - saving model for epoch 18
2022-10-02 18:54:44,211 - INFO - epoch 18 finished
2022-10-02 18:54:44,211 - INFO - time for one epoch: 0:05:49.942467
2022-10-02 18:54:44,211 - INFO - start validating
2022-10-02 18:54:49,356 - INFO - validate epoch 18: loss 3.9737913493187196
2022-10-02 18:54:49,356 - INFO - time for validating one epoch: 0:00:05.143538
2022-10-02 19:00:57,924 - INFO - epoch 19: loss 3.9522847591388235, predict_acc 0.2888292614774314
2022-10-02 19:00:57,924 - INFO - saving model for epoch 19
2022-10-02 19:00:57,939 - INFO - epoch 19 finished
2022-10-02 19:00:57,939 - INFO - time for one epoch: 0:06:08.581749
2022-10-02 19:00:57,940 - INFO - start validating
2022-10-02 19:00:59,961 - INFO - validate epoch 19: loss 3.9702953254022906
2022-10-02 19:00:59,961 - INFO - time for validating one epoch: 0:00:02.021534
2022-10-02 19:06:37,249 - INFO - epoch 20: loss 3.9486693357571383, predict_acc 0.2892055802711533
2022-10-02 19:06:37,249 - INFO - saving model for epoch 20
2022-10-02 19:06:37,263 - INFO - epoch 20 finished
2022-10-02 19:06:37,263 - INFO - time for one epoch: 0:05:37.301250
2022-10-02 19:06:37,263 - INFO - start validating
2022-10-02 19:06:39,280 - INFO - validate epoch 20: loss 3.970076726328942
2022-10-02 19:06:39,280 - INFO - time for validating one epoch: 0:00:02.016562
2022-10-02 19:06:39,281 - INFO - training finished
2022-10-02 19:06:39,282 - INFO - train_losses:[6.452935256903413, 5.84880469808844, 5.504782692578941, 4.866746432701189, 4.4748978772387975, 4.293014819690904, 4.198841280531455, 4.139222974489358, 4.096574731770202, 4.064923918560523, 4.040317541294162, 4.020454346559769, 4.004453166586454, 3.991115715117185, 3.980092799945824, 3.970891044377474, 3.963239038421746, 3.9571356880705153, 3.9522847591388235, 3.9486693357571383]
2022-10-02 19:06:39,282 - INFO - validate_losses:[5.842085638353901, 5.83592285648469, 5.140258258388888, 4.612686257208547, 4.34886460919534, 4.231362396670926, 4.161822642049482, 4.115418095742503, 4.080973659792254, 4.05679528943954, 4.037642705825068, 4.020590413001276, 4.010497081664301, 3.9991203815706315, 3.991109698049484, 3.983988235073705, 3.97857153800226, 3.9737913493187196, 3.9702953254022906, 3.970076726328942]
2022-10-02 19:06:39,292 - INFO - using device:cuda:0
2022-10-02 19:06:39,292 - INFO - args:Namespace(batch_size=128, cls_id=6, cuda='True', device='cuda:0', embedding_dim=128, epochs=20, eps=1e-09, gradient_accumulation_steps=4, hidden_dim=128, ignore_index=-100, log=True, log_path='../log/', log_step=1000, lr=0.002, max_grad_norm=2.0, max_len=150, model_config='../config/config.json', model_type='lstm', num_workers=0, pad_id=0, patience=0, pretrained_model='', save_model_path='../model', sep_id=7, train_path='../data/train.pkl', val_num=8000, vec_path='../word2vec/', vec_type='cbow', vocab_path='../data/vocab.txt', vocab_size=8318, warmup_steps=4000)
2022-10-02 19:06:39,707 - INFO - Train:lstm-cbow
2022-10-02 19:06:39,708 - INFO - number of model parameters: 2401918
2022-10-02 19:06:39,723 - INFO - starting training
2022-10-02 19:12:00,414 - INFO - epoch 1: loss 6.453421082249725, predict_acc 0.0725625154908962
2022-10-02 19:12:00,414 - INFO - saving model for epoch 1
2022-10-02 19:12:00,427 - INFO - epoch 1 finished
2022-10-02 19:12:00,427 - INFO - time for one epoch: 0:05:20.532368
2022-10-02 19:12:00,428 - INFO - start validating
2022-10-02 19:12:02,419 - INFO - validate epoch 1: loss 5.843665938223562
2022-10-02 19:12:02,420 - INFO - time for validating one epoch: 0:00:01.992216
2022-10-02 19:17:16,907 - INFO - epoch 2: loss 5.84870364434577, predict_acc 0.09046970020291742
2022-10-02 19:17:16,907 - INFO - saving model for epoch 2
2022-10-02 19:17:16,920 - INFO - epoch 2 finished
2022-10-02 19:17:16,920 - INFO - time for one epoch: 0:05:14.499707
2022-10-02 19:17:16,920 - INFO - start validating
2022-10-02 19:17:18,883 - INFO - validate epoch 2: loss 5.838574094157065
2022-10-02 19:17:18,884 - INFO - time for validating one epoch: 0:00:01.964405
2022-10-02 19:22:33,000 - INFO - epoch 3: loss 5.44208809797757, predict_acc 0.12496896716832807
2022-10-02 19:22:33,000 - INFO - saving model for epoch 3
2022-10-02 19:22:33,013 - INFO - epoch 3 finished
2022-10-02 19:22:33,013 - INFO - time for one epoch: 0:05:14.128496
2022-10-02 19:22:33,013 - INFO - start validating
2022-10-02 19:22:34,982 - INFO - validate epoch 3: loss 4.962828282387026
2022-10-02 19:22:34,982 - INFO - time for validating one epoch: 0:00:01.969510
2022-10-02 19:27:47,409 - INFO - epoch 4: loss 4.6906405976747365, predict_acc 0.21690323846069817
2022-10-02 19:27:47,410 - INFO - saving model for epoch 4
2022-10-02 19:27:47,422 - INFO - epoch 4 finished
2022-10-02 19:27:47,422 - INFO - time for one epoch: 0:05:12.438505
2022-10-02 19:27:47,422 - INFO - start validating
2022-10-02 19:27:49,385 - INFO - validate epoch 4: loss 4.48249545404988
2022-10-02 19:27:49,385 - INFO - time for validating one epoch: 0:00:01.962516
2022-10-02 19:33:01,358 - INFO - epoch 5: loss 4.386369977678571, predict_acc 0.24794426156722263
2022-10-02 19:33:01,358 - INFO - saving model for epoch 5
2022-10-02 19:33:01,371 - INFO - epoch 5 finished
2022-10-02 19:33:01,371 - INFO - time for one epoch: 0:05:11.984780
2022-10-02 19:33:01,371 - INFO - start validating
2022-10-02 19:33:03,330 - INFO - validate epoch 5: loss 4.292762764038578
2022-10-02 19:33:03,330 - INFO - time for validating one epoch: 0:00:01.958049
2022-10-02 19:38:14,931 - INFO - epoch 6: loss 4.249703043796977, predict_acc 0.2604082926694661
2022-10-02 19:38:14,931 - INFO - saving model for epoch 6
2022-10-02 19:38:14,943 - INFO - epoch 6 finished
2022-10-02 19:38:14,944 - INFO - time for one epoch: 0:05:11.612841
2022-10-02 19:38:14,944 - INFO - start validating
2022-10-02 19:38:16,894 - INFO - validate epoch 6: loss 4.199706608249295
2022-10-02 19:38:16,895 - INFO - time for validating one epoch: 0:00:01.950537
2022-10-02 19:43:31,102 - INFO - epoch 7: loss 4.1716194426427124, predict_acc 0.2679301983608109
2022-10-02 19:43:31,102 - INFO - saving model for epoch 7
2022-10-02 19:43:31,116 - INFO - epoch 7 finished
2022-10-02 19:43:31,117 - INFO - time for one epoch: 0:05:14.222374
2022-10-02 19:43:31,117 - INFO - start validating
2022-10-02 19:43:33,333 - INFO - validate epoch 7: loss 4.140087066158172
2022-10-02 19:43:33,333 - INFO - time for validating one epoch: 0:00:02.215683
